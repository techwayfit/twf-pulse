@page "/facilitator/live/presentation"
@layout PresentationModeLayout
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@using TechWayFit.Pulse.Contracts.Enums
@using TechWayFit.Pulse.Web.Components.Presentation

<PageTitle>Presentation Mode - @(session?.Title ?? "TechWayFit Pulse")</PageTitle>

@if (isLoading)
{
    <div class="presentation-container">
        <div class="presentation-content">
            <div class="activity-display">
                <div class="waiting-state">
                    <svg class="waiting-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM12 20C7.59 20 4 16.41 4 12C4 7.59 7.59 4 12 4C16.41 4 20 7.59 20 12C20 16.41 16.41 20 12 20Z"/>
                    </svg>
                    <h3>Loading presentation...</h3>
                    <p>Please wait</p>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <PresentationLayout
        Title="Presentation Mode"
        SessionTitle="@SessionTitle"
        SessionCode="@SessionCode"
        SessionTTL="@SessionTTL"
        ParticipantCount="@participantCount"
        ShowFooter="true"
        CurrentActivityNumber="@CurrentActivityNumber"
        TotalActivities="@TotalActivities"
        HasPrevious="@hasPrevious"
        HasNext="@hasNext"
        OnExit="@ExitPresenterMode"
        OnPrevious="@GoBack"
        OnNext="@MoveNext">
        
        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="activity-display">
                <div class="waiting-state">
                    <svg class="waiting-icon" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M12 2C6.48 2 2 6.48 2 12C2 17.52 6.48 22 12 22C17.52 22 22 17.52 22 12C22 6.48 17.52 2 12 2ZM13 17H11V15H13V17ZM13 13H11V7H13V13Z"/>
                    </svg>
                    <h3>@errorMessage</h3>
                    <p>Please return to the live view</p>
                </div>
            </div>
        }
        else if (activity != null)
        {
            @if (activity.Type == ActivityType.Poll)
            {
                <PollPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else if (activity.Type == ActivityType.WordCloud)
            {
                <WordCloudPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else if (activity.Type == ActivityType.Rating)
            {
                <RatingPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt"
                    MaxRating="5" />
            }
            else if (activity.Type == ActivityType.Quadrant)
            {
                <QuadrantPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else if (activity.Type == ActivityType.GeneralFeedback)
            {
                <GeneralFeedbackPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else
            {
                <div class="activity-display">
                    <div class="waiting-state">
                        <svg class="waiting-icon" viewBox="0 0 24 24" fill="currentColor">
                            <path d="M19 3H5C3.9 3 3 3.9 3 5V19C3 20.1 3.9 21 5 21H19C20.1 21 21 20.1 21 19V5C21 3.9 20.1 3 19 3ZM19 19H5V5H19V19Z"/>
                        </svg>
                        <h3>Activity type not supported</h3>
                        <p>Presentation mode for @activity.Type activities is coming soon</p>
                    </div>
                </div>
            }
        }
    </PresentationLayout>
}