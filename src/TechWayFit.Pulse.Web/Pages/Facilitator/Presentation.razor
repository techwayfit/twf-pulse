@page "/facilitator/live/presentation"
@layout PresentationModeLayout
@attribute [Microsoft.AspNetCore.Authorization.Authorize]
@using TechWayFit.Pulse.Contracts.Enums
@using TechWayFit.Pulse.Web.Components.Presentation

<PageTitle>Presentation Mode - @(session?.Title ?? "TechWayFit Pulse")</PageTitle>

@if (isLoading)
{
    <div class="presentation-container">
        <div class="presentation-content">
            <div class="activity-display">
                <div class="waiting-state">
                    <i class="ics ics-hourglass waiting-icon"></i>
                    <h3>Loading presentation...</h3>
                    <p>Please wait</p>
                </div>
            </div>
        </div>
    </div>
}
else
{
    <PresentationLayout
        Title="Presentation Mode"
        SessionTitle="@SessionTitle"
        SessionCode="@SessionCode"
        SessionTTL="@SessionTTL"
        ParticipantCount="@participantCount"
        ShowFooter="true"
        CurrentActivityNumber="@CurrentActivityNumber"
        TotalActivities="@TotalActivities"
        HasPrevious="@hasPrevious"
        HasNext="@hasNext"
        OnExit="@ExitPresenterMode"
        OnPrevious="@GoBack"
        OnNext="@MoveNext">
        
        @if (!string.IsNullOrEmpty(errorMessage))
        {
            <div class="activity-display">
                <div class="waiting-state">
                    <i class="ics ics-warning waiting-icon"></i>
                    <h3>@errorMessage</h3>
                    <p>Please return to the live view</p>
                </div>
            </div>
        }
        else if (activity != null)
        {
            @if (activity.Type == ActivityType.Poll)
            {
                <PollPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else if (activity.Type == ActivityType.WordCloud)
            {
                <WordCloudPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else if (activity.Type == ActivityType.Rating)
            {
                <RatingPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt"
                    MaxRating="5" />
            }
            else if (activity.Type == ActivityType.Quadrant)
            {
                <QuadrantPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt"
                    ActivityConfig="@activity.Config" />
            }
            else if (activity.Type == ActivityType.GeneralFeedback)
            {
                <GeneralFeedbackPresentation 
                    SessionCode="@SessionCode" 
                    ActivityId="@activity.ActivityId"
                    ActivityTitle="@activity.Title"
                    ActivityPrompt="@activity.Prompt"
                    DurationMinutes="@activity.DurationMinutes"
                    OpenedAt="@activity.OpenedAt" />
            }
            else
            {
                <div class="activity-display">
                    <div class="waiting-state">
                        <i class="ics ics-info waiting-icon"></i>
                        <h3>Activity type not supported</h3>
                        <p>Presentation mode for @activity.Type activities is coming soon</p>
                    </div>
                </div>
            }
        }
    </PresentationLayout>
}