@using TechWayFit.Pulse.Contracts.Enums
@using TechWayFit.Pulse.Contracts.Responses

<!-- Header - Mobile Optimized -->
<div class="mb-3">
    <!-- Desktop Layout -->
    <div class="d-none d-md-flex justify-content-between align-items-center">
        <div>
 <h2 class="mb-0 h4">@Session.Title</h2>
      <div class="text-muted small mt-1">
              Code: <span class="badge bg-primary bg-opacity-10 text-primary">@SessionCode</span>
<span class="mx-2">TTL: <strong>4h</strong></span>
 </div>
        </div>
        <div class="d-flex gap-2 align-items-center">
        @if (Session.Status == SessionStatus.Live)
            {
      <span class="badge bg-success-subtle text-success px-3 py-2">LIVE</span>
    }
  <button class="btn btn-sm btn-outline-secondary" @onclick="OnShowEditSession">
  <i class="fas fa-edit me-1"></i>Edit Session
            </button>
            <button class="btn btn-sm btn-outline-primary" @onclick="OnShowQRModal">
  <i class="fas fa-qrcode me-1"></i>Show Joining Information
       </button>
            @if (Session.Status == SessionStatus.Live)
            {
       <button class="btn btn-sm btn-danger" @onclick="OnEndSession" disabled="@IsPerformingAction">
        End Session
         </button>
            }
    else if (Session.Status == SessionStatus.Draft)
       {
        <button class="btn btn-sm btn-success" @onclick="OnStartSession" disabled="@IsPerformingAction">
     Start Session
      </button>
            }
      </div>
    </div>

    <!-- Mobile Layout -->
    <div class="d-md-none">
        <!-- Line 1: Title + LIVE indicator -->
        <div class="d-flex justify-content-between align-items-center mb-2">
   <h2 class="mb-0 h5 flex-grow-1">@Session.Title</h2>
            @if (Session.Status == SessionStatus.Live)
            {
  <span class="badge bg-success text-white px-2 py-1">LIVE</span>
   }
        </div>
 <!-- Line 2: Code + TTL -->
        <div class="small text-muted mb-2">
         Code: <span class="badge bg-primary bg-opacity-10 text-primary">@SessionCode</span>
    <span class="ms-2">TTL: <strong>4h</strong></span>
        </div>
        <!-- Line 3: Buttons -->
        <div class="d-flex gap-2">
            <button class="btn btn-sm btn-outline-primary flex-grow-1" @onclick="OnShowQRModal">
  <i class="fas fa-qrcode me-1"></i>Join Info
            </button>
            @if (Session.Status == SessionStatus.Live)
    {
<button class="btn btn-sm btn-danger" @onclick="OnEndSession" disabled="@IsPerformingAction">
        End Session
           </button>
            }
  else if (Session.Status == SessionStatus.Draft)
        {
           <button class="btn btn-sm btn-success" @onclick="OnStartSession" disabled="@IsPerformingAction">
        Start Session
       </button>
   }
        </div>
    </div>
</div>

@code {
    [Parameter, EditorRequired]
    public SessionSummaryResponse Session { get; set; } = default!;

    [Parameter, EditorRequired]
    public string SessionCode { get; set; } = default!;

    [Parameter]
    public bool IsPerformingAction { get; set; }

    [Parameter]
    public EventCallback OnShowQRModal { get; set; }

    [Parameter]
    public EventCallback OnShowEditSession { get; set; }

    [Parameter]
    public EventCallback OnStartSession { get; set; }

    [Parameter]
    public EventCallback OnEndSession { get; set; }
}
